/*! protobuf.js v6.7.2 (c) 2016, Daniel Wirtz * Compiled Sat, 08 Apr 2017 08:16:52 UTC * Licensed under the BSD-3-Clause License * see: https://github.com/dcodeIO/protobuf.js for details */
!function(t,r){"use strict";!function(r,e,n){function i(t){var n=e[t];return n||r[t][0].call(n=e[t]={exports:{}},i,n,n.exports),n.exports}var o=t.protobuf=i(n[0]);"function"==typeof define&&define.amd&&define(["long"],function(t){return t&&t.isLong&&(o.util.Long=t,o.configure()),o}),"object"==typeof module&&module&&module.exports&&(module.exports=o)}({1:[function(t,r){function e(t,r){for(var e=[],n=2;n<arguments.length;)e.push(arguments[n++]);var i=!0;return new Promise(function(n,o){e.push(function(t){if(i)if(i=!1,t)o(t);else{for(var r=[],e=1;e<arguments.length;)r.push(arguments[e++]);n.apply(null,r)}});try{t.apply(r||this,e)}catch(t){i&&(i=!1,o(t))}})}r.exports=e},{}],2:[function(t,e,n){var i=n;i.length=function(t){var r=t.length;if(!r)return 0;for(var e=0;--r%4>1&&"="===t.charAt(r);)++e;return Math.ceil(3*t.length)/4-e};for(var o=Array(64),s=Array(123),u=0;u<64;)s[o[u]=u<26?u+65:u<52?u+71:u<62?u-4:u-59|43]=u++;i.encode=function(t,r,e){for(var n,i=[],s=0,u=0;r<e;){var f=t[r++];switch(u){case 0:i[s++]=o[f>>2],n=(3&f)<<4,u=1;break;case 1:i[s++]=o[n|f>>4],n=(15&f)<<2,u=2;break;case 2:i[s++]=o[n|f>>6],i[s++]=o[63&f],u=0}}return u&&(i[s++]=o[n],i[s]=61,1===u&&(i[s+1]=61)),String.fromCharCode.apply(String,i)};i.decode=function(t,e,n){for(var i,o=n,u=0,f=0;f<t.length;){var h=t.charCodeAt(f++);if(61===h&&u>1)break;if((h=s[h])===r)throw Error("invalid encoding");switch(u){case 0:i=h,u=1;break;case 1:e[n++]=i<<2|(48&h)>>4,i=h,u=2;break;case 2:e[n++]=(15&i)<<4|(60&h)>>2,i=h,u=3;break;case 3:e[n++]=(3&i)<<6|h,u=0}}if(1===u)throw Error("invalid encoding");return n-o},i.test=function(t){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(t)}},{}],3:[function(t,e){function n(){this.a={}}e.exports=n,n.prototype.on=function(t,r,e){return(this.a[t]||(this.a[t]=[])).push({fn:r,ctx:e||this}),this},n.prototype.off=function(t,e){if(t===r)this.a={};else if(e===r)this.a[t]=[];else for(var n=this.a[t],i=0;i<n.length;)n[i].fn===e?n.splice(i,1):++i;return this},n.prototype.emit=function(t){var r=this.a[t];if(r){for(var e=[],n=1;n<arguments.length;)e.push(arguments[n++]);for(n=0;n<r.length;)r[n].fn.apply(r[n++].ctx,e)}return this}},{}],4:[function(t,r){function e(t){return"undefined"!=typeof Float32Array?function(){function r(t,r,e){o[0]=t,r[e]=s[0],r[e+1]=s[1],r[e+2]=s[2],r[e+3]=s[3]}function e(t,r,e){o[0]=t,r[e]=s[3],r[e+1]=s[2],r[e+2]=s[1],r[e+3]=s[0]}function n(t,r){return s[0]=t[r],s[1]=t[r+1],s[2]=t[r+2],s[3]=t[r+3],o[0]}function i(t,r){return s[3]=t[r],s[2]=t[r+1],s[1]=t[r+2],s[0]=t[r+3],o[0]}var o=new Float32Array([-0]),s=new Uint8Array(o.buffer),u=128===s[3];t.writeFloatLE=u?r:e,t.writeFloatBE=u?e:r,t.readFloatLE=u?n:i,t.readFloatBE=u?i:n}():function(){function r(t,r,e,n){var i=r<0?1:0;if(i&&(r=-r),0===r)t(1/r>0?0:2147483648,e,n);else if(isNaN(r))t(2143289344,e,n);else if(r>3.4028234663852886e38)t((i<<31|2139095040)>>>0,e,n);else if(r<1.1754943508222875e-38)t((i<<31|Math.round(r/1.401298464324817e-45))>>>0,e,n);else{var o=Math.floor(Math.log(r)/Math.LN2),s=8388607&Math.round(r*Math.pow(2,-o)*8388608);t((i<<31|o+127<<23|s)>>>0,e,n)}}function e(t,r,e){var n=t(r,e),i=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:i*(1/0):0===o?1.401298464324817e-45*i*s:i*Math.pow(2,o-150)*(s+8388608)}t.writeFloatLE=r.bind(null,n),t.writeFloatBE=r.bind(null,i),t.readFloatLE=e.bind(null,o),t.readFloatBE=e.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){function r(t,r,e){o[0]=t,r[e]=s[0],r[e+1]=s[1],r[e+2]=s[2],r[e+3]=s[3],r[e+4]=s[4],r[e+5]=s[5],r[e+6]=s[6],r[e+7]=s[7]}function e(t,r,e){o[0]=t,r[e]=s[7],r[e+1]=s[6],r[e+2]=s[5],r[e+3]=s[4],r[e+4]=s[3],r[e+5]=s[2],r[e+6]=s[1],r[e+7]=s[0]}function n(t,r){return s[0]=t[r],s[1]=t[r+1],s[2]=t[r+2],s[3]=t[r+3],s[4]=t[r+4],s[5]=t[r+5],s[6]=t[r+6],s[7]=t[r+7],o[0]}function i(t,r){return s[7]=t[r],s[6]=t[r+1],s[5]=t[r+2],s[4]=t[r+3],s[3]=t[r+4],s[2]=t[r+5],s[1]=t[r+6],s[0]=t[r+7],o[0]}var o=new Float64Array([-0]),s=new Uint8Array(o.buffer),u=128===s[7];t.writeDoubleLE=u?r:e,t.writeDoubleBE=u?e:r,t.readDoubleLE=u?n:i,t.readDoubleBE=u?i:n}():function(){function r(t,r,e,n,i,o){var s=n<0?1:0;if(s&&(n=-n),0===n)t(0,i,o+r),t(1/n>0?0:2147483648,i,o+e);else if(isNaN(n))t(0,i,o+r),t(2146959360,i,o+e);else if(n>1.7976931348623157e308)t(0,i,o+r),t((s<<31|2146435072)>>>0,i,o+e);else{var u;if(n<2.2250738585072014e-308)u=n/5e-324,t(u>>>0,i,o+r),t((s<<31|u/4294967296)>>>0,i,o+e);else{var f=Math.floor(Math.log(n)/Math.LN2);1024===f&&(f=1023),u=n*Math.pow(2,-f),t(4503599627370496*u>>>0,i,o+r),t((s<<31|f+1023<<20|1048576*u&1048575)>>>0,i,o+e)}}}function e(t,r,e,n,i){var o=t(n,i+r),s=t(n,i+e),u=2*(s>>31)+1,f=s>>>20&2047,h=4294967296*(1048575&s)+o;return 2047===f?h?NaN:u*(1/0):0===f?5e-324*u*h:u*Math.pow(2,f-1075)*(h+4503599627370496)}t.writeDoubleLE=r.bind(null,n,0,4),t.writeDoubleBE=r.bind(null,i,4,0),t.readDoubleLE=e.bind(null,o,0,4),t.readDoubleBE=e.bind(null,s,4,0)}(),t}function n(t,r,e){r[e]=255&t,r[e+1]=t>>>8&255,r[e+2]=t>>>16&255,r[e+3]=t>>>24}function i(t,r,e){r[e]=t>>>24,r[e+1]=t>>>16&255,r[e+2]=t>>>8&255,r[e+3]=255&t}function o(t,r){return(t[r]|t[r+1]<<8|t[r+2]<<16|t[r+3]<<24)>>>0}function s(t,r){return(t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3])>>>0}r.exports=e(e)},{}],5:[function(t,r,e){function n(t){try{var r=eval("quire".replace(/^/,"re"))(t);if(r&&(r.length||Object.keys(r).length))return r}catch(t){}return null}r.exports=n},{}],6:[function(t,r){function e(t,r,e){var n=e||8192,i=n>>>1,o=null,s=n;return function(e){if(e<1||e>i)return t(e);s+e>n&&(o=t(n),s=0);var u=r.call(o,s,s+=e);return 7&s&&(s=1+(7|s)),u}}r.exports=e},{}],7:[function(t,r,e){var n=e;n.length=function(t){for(var r=0,e=0,n=0;n<t.length;++n)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:55296==(64512&e)&&56320==(64512&t.charCodeAt(n+1))?(++n,r+=4):r+=3;return r},n.read=function(t,r,e){if(e-r<1)return"";for(var n,i=null,o=[],s=0;r<e;)n=t[r++],n<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&t[r++]:n>239&&n<365?(n=((7&n)<<18|(63&t[r++])<<12|(63&t[r++])<<6|63&t[r++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&t[r++])<<6|63&t[r++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},n.write=function(t,r,e){for(var n,i,o=e,s=0;s<t.length;++s)n=t.charCodeAt(s),n<128?r[e++]=n:n<2048?(r[e++]=n>>6|192,r[e++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=t.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&i),++s,r[e++]=n>>18|240,r[e++]=n>>12&63|128,r[e++]=n>>6&63|128,r[e++]=63&n|128):(r[e++]=n>>12|224,r[e++]=n>>6&63|128,r[e++]=63&n|128);return e-o}},{}],8:[function(t,r,e){function n(){i.Reader.b(i.BufferReader),i.util.b()}var i=e;i.build="minimal",i.roots={},i.Writer=t(15),i.BufferWriter=t(16),i.Reader=t(9),i.BufferReader=t(10),i.util=t(14),i.rpc=t(11),i.configure=n,i.Writer.b(i.BufferWriter),n()},{10:10,11:11,14:14,15:15,16:16,9:9}],9:[function(t,r){function e(t,r){return RangeError("index out of range: "+t.pos+" + "+(r||1)+" > "+t.len)}function n(t){this.buf=t,this.pos=0,this.len=t.length}function i(){var t=new h(0,0),r=0;if(!(this.len-this.pos>4)){for(;r<3;++r){if(this.pos>=this.len)throw e(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*r)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*r)>>>0,t}for(;r<4;++r)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*r)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(r=0,this.len-this.pos>4){for(;r<5;++r)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*r+3)>>>0,this.buf[this.pos++]<128)return t}else for(;r<5;++r){if(this.pos>=this.len)throw e(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*r+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function o(t,r){return(t[r-4]|t[r-3]<<8|t[r-2]<<16|t[r-1]<<24)>>>0}function s(){if(this.pos+8>this.len)throw e(this,8);return new h(o(this.buf,this.pos+=4),o(this.buf,this.pos+=4))}r.exports=n;var u,f=t(14),h=f.LongBits,a=f.utf8,l="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new n(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new n(t);throw Error("illegal buffer")};n.create=f.Buffer?function(t){return(n.create=function(t){return f.Buffer.isBuffer(t)?new u(t):l(t)})(t)}:l,n.prototype.c=f.Array.prototype.subarray||f.Array.prototype.slice,n.prototype.uint32=function(){var t=4294967295;return function(){if(t=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return t;if((this.pos+=5)>this.len)throw this.pos=this.len,e(this,10);return t}}(),n.prototype.int32=function(){return 0|this.uint32()},n.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},n.prototype.bool=function(){return 0!==this.uint32()},n.prototype.fixed32=function(){if(this.pos+4>this.len)throw e(this,4);return o(this.buf,this.pos+=4)},n.prototype.sfixed32=function(){if(this.pos+4>this.len)throw e(this,4);return 0|o(this.buf,this.pos+=4)},n.prototype.float=function(){if(this.pos+4>this.len)throw e(this,4);var t=f.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},n.prototype.double=function(){if(this.pos+8>this.len)throw e(this,4);var t=f.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},n.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw e(this,t);return this.pos+=t,r===n?new this.buf.constructor(0):this.c.call(this.buf,r,n)},n.prototype.string=function(){var t=this.bytes();return a.read(t,0,t.length)},n.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw e(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw e(this)}while(128&this.buf[this.pos++]);return this},n.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;;){if(4==(t=7&this.uint32()))break;this.skipType(t)}break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},n.b=function(t){u=t;var r=f.Long?"toLong":"toNumber";f.merge(n.prototype,{int64:function(){return i.call(this)[r](!1)},uint64:function(){return i.call(this)[r](!0)},sint64:function(){return i.call(this).zzDecode()[r](!1)},fixed64:function(){return s.call(this)[r](!0)},sfixed64:function(){return s.call(this)[r](!1)}})}},{14:14}],10:[function(t,r){function e(t){n.call(this,t)}r.exports=e;var n=t(9);(e.prototype=Object.create(n.prototype)).constructor=e;var i=t(14);i.Buffer&&(e.prototype.c=i.Buffer.prototype.slice),e.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len))}},{14:14,9:9}],11:[function(t,r,e){e.Service=t(12)},{12:12}],12:[function(t,e){function n(t,r,e){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!r,this.responseDelimited=!!e}e.exports=n;var i=t(14);(n.prototype=Object.create(i.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function t(e,n,o,s,u){if(!s)throw TypeError("request must be specified");var f=this;if(!u)return i.asPromise(t,f,e,n,o,s);if(!f.rpcImpl)return setTimeout(function(){u(Error("already ended"))},0),r;try{return f.rpcImpl(e,n[f.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(t,n){if(t)return f.emit("error",t,e),u(t);if(null===n)return f.end(!0),r;if(!(n instanceof o))try{n=o[f.responseDelimited?"decodeDelimited":"decode"](n)}catch(t){return f.emit("error",t,e),u(t)}return f.emit("data",n,e),u(null,n)})}catch(t){return f.emit("error",t,e),setTimeout(function(){u(t)},0),r}},n.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{14:14}],13:[function(t,r){function e(t,r){this.lo=t>>>0,this.hi=r>>>0}r.exports=e;var n=t(14),i=e.zero=new e(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=e.zeroHash="\0\0\0\0\0\0\0\0";e.fromNumber=function(t){if(0===t)return i;var r=t<0;r&&(t=-t);var n=t>>>0,o=(t-n)/4294967296>>>0;return r&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new e(n,o)},e.from=function(t){if("number"==typeof t)return e.fromNumber(t);if(n.isString(t)){if(!n.Long)return e.fromNumber(parseInt(t,10));t=n.Long.fromString(t)}return t.low||t.high?new e(t.low>>>0,t.high>>>0):i},e.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=1+~this.lo>>>0,e=~this.hi>>>0;return r||(e=e+1>>>0),-(r+4294967296*e)}return this.lo+4294967296*this.hi},e.prototype.toLong=function(t){return n.Long?new n.Long(0|this.lo,0|this.hi,!!t):{low:0|this.lo,high:0|this.hi,unsigned:!!t}};var s=String.prototype.charCodeAt;e.fromHash=function(t){return t===o?i:new e((s.call(t,0)|s.call(t,1)<<8|s.call(t,2)<<16|s.call(t,3)<<24)>>>0,(s.call(t,4)|s.call(t,5)<<8|s.call(t,6)<<16|s.call(t,7)<<24)>>>0)},e.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},e.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},e.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},e.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,e=this.hi>>>24;return 0===e?0===r?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:e<128?9:10}},{14:14}],14:[function(e,n,i){function o(t,e,n){for(var i=Object.keys(e),o=0;o<i.length;++o)t[i[o]]!==r&&n||(t[i[o]]=e[i[o]]);return t}function s(t){function r(t,e){if(!(this instanceof r))return new r(t,e);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,r):Object.defineProperty(this,"stack",{value:Error().stack||""}),e&&o(this,e)}return(r.prototype=Object.create(Error.prototype)).constructor=r,Object.defineProperty(r.prototype,"name",{get:function(){return t}}),r.prototype.toString=function(){return this.name+": "+this.message},r}var u=i;u.asPromise=e(1),u.base64=e(2),u.EventEmitter=e(3),u.float=e(4),u.inquire=e(5),u.utf8=e(7),u.pool=e(6),u.LongBits=e(13),u.emptyArray=Object.freeze?Object.freeze([]):[],u.emptyObject=Object.freeze?Object.freeze({}):{},u.isNode=!!(t.process&&t.process.versions&&t.process.versions.node),u.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},u.isString=function(t){return"string"==typeof t||t instanceof String},u.isObject=function(t){return t&&"object"==typeof t},u.isset=u.isSet=function(t,r){var e=t[r];return!(null==e||!t.hasOwnProperty(r))&&("object"!=typeof e||(Array.isArray(e)?e.length:Object.keys(e).length)>0)},u.Buffer=function(){try{var t=u.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),u.d=null,u.e=null,u.newBuffer=function(t){return"number"==typeof t?u.Buffer?u.e(t):new u.Array(t):u.Buffer?u.d(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},u.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,u.Long=t.dcodeIO&&t.dcodeIO.Long||u.inquire("long"),u.key2Re=/^true|false|0|1$/,u.key32Re=/^-?(?:0|[1-9][0-9]*)$/,u.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,u.longToHash=function(t){return t?u.LongBits.from(t).toHash():u.LongBits.zeroHash},u.longFromHash=function(t,r){var e=u.LongBits.fromHash(t);return u.Long?u.Long.fromBits(e.lo,e.hi,r):e.toNumber(!!r)},u.merge=o,u.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},u.newError=s,u.ProtocolError=s("ProtocolError"),u.oneOfGetter=function(t){for(var e={},n=0;n<t.length;++n)e[t[n]]=1;return function(){for(var t=Object.keys(this),n=t.length-1;n>-1;--n)if(1===e[t[n]]&&this[t[n]]!==r&&null!==this[t[n]])return t[n]}},u.oneOfSetter=function(t){return function(r){for(var e=0;e<t.length;++e)t[e]!==r&&delete this[t[e]]}},u.lazyResolve=function(t,r){for(var e=0;e<r.length;++e)for(var n=Object.keys(r[e]),i=0;i<n.length;++i){for(var o=r[e][n[i]].split("."),s=t;o.length;)s=s[o.shift()];r[e][n[i]]=s}},u.toJSONOptions={longs:String,enums:String,bytes:String},u.b=function(){var t=u.Buffer;if(!t)return void(u.d=u.e=null);u.d=t.from!==Uint8Array.from&&t.from||function(r,e){return new t(r,e)},u.e=t.allocUnsafe||function(r){return new t(r)}}},{1:1,13:13,2:2,3:3,4:4,5:5,6:6,7:7}],15:[function(t,e){function n(t,e,n){this.fn=t,this.len=e,this.next=r,this.val=n}function i(){}function o(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function s(){this.len=0,this.head=new n(i,0,0),this.tail=this.head,this.states=null}function u(t,r,e){r[e]=255&t}function f(t,r,e){for(;t>127;)r[e++]=127&t|128,t>>>=7;r[e]=t}function h(t,e){this.len=t,this.next=r,this.val=e}function a(t,r,e){for(;t.hi;)r[e++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)r[e++]=127&t.lo|128,t.lo=t.lo>>>7;r[e++]=t.lo}function l(t,r,e){r[e]=255&t,r[e+1]=t>>>8&255,r[e+2]=t>>>16&255,r[e+3]=t>>>24}e.exports=s;var c,p=t(14),y=p.LongBits,d=p.base64,b=p.utf8;s.create=p.Buffer?function(){return(s.create=function(){return new c})()}:function(){return new s},s.alloc=function(t){return new p.Array(t)},p.Array!==Array&&(s.alloc=p.pool(s.alloc,p.Array.prototype.subarray)),s.prototype.push=function(t,r,e){return this.tail=this.tail.next=new n(t,r,e),this.len+=r,this},h.prototype=Object.create(n.prototype),h.prototype.fn=f,s.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new h((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},s.prototype.int32=function(t){return t<0?this.push(a,10,y.fromNumber(t)):this.uint32(t)},s.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},s.prototype.uint64=function(t){var r=y.from(t);return this.push(a,r.length(),r)},s.prototype.int64=s.prototype.uint64,s.prototype.sint64=function(t){var r=y.from(t).zzEncode();return this.push(a,r.length(),r)},s.prototype.bool=function(t){return this.push(u,1,t?1:0)},s.prototype.fixed32=function(t){return this.push(l,4,t>>>0)},s.prototype.sfixed32=s.prototype.fixed32,s.prototype.fixed64=function(t){var r=y.from(t);return this.push(l,4,r.lo).push(l,4,r.hi)},s.prototype.sfixed64=s.prototype.fixed64,s.prototype.float=function(t){return this.push(p.float.writeFloatLE,4,t)},s.prototype.double=function(t){return this.push(p.float.writeDoubleLE,8,t)};var g=p.Array.prototype.set?function(t,r,e){r.set(t,e)}:function(t,r,e){for(var n=0;n<t.length;++n)r[e+n]=t[n]};s.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this.push(u,1,0);if(p.isString(t)){var e=s.alloc(r=d.length(t));d.decode(t,e,0),t=e}return this.uint32(r).push(g,r,t)},s.prototype.string=function(t){var r=b.length(t);return r?this.uint32(r).push(b.write,r,t):this.push(u,1,0)},s.prototype.fork=function(){return this.states=new o(this),this.head=this.tail=new n(i,0,0),this.len=0,this},s.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new n(i,0,0),this.len=0),this},s.prototype.ldelim=function(){var t=this.head,r=this.tail,e=this.len;return this.reset().uint32(e),e&&(this.tail.next=t.next,this.tail=r,this.len+=e),this},s.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),e=0;t;)t.fn(t.val,r,e),e+=t.len,t=t.next;return r},s.b=function(t){c=t}},{14:14}],16:[function(t,r){function e(){i.call(this)}function n(t,r,e){t.length<40?o.utf8.write(t,r,e):r.utf8Write(t,e)}r.exports=e;var i=t(15);(e.prototype=Object.create(i.prototype)).constructor=e;var o=t(14),s=o.Buffer;e.alloc=function(t){return(e.alloc=o.e)(t)};var u=s&&s.prototype instanceof Uint8Array&&"set"===s.prototype.set.name?function(t,r,e){r.set(t,e)}:function(t,r,e){if(t.copy)t.copy(r,e,0,t.length);else for(var n=0;n<t.length;)r[e++]=t[n++]};e.prototype.bytes=function(t){o.isString(t)&&(t=o.d(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this.push(u,r,t),this},e.prototype.string=function(t){var r=s.byteLength(t);return this.uint32(r),r&&this.push(n,r,t),this}},{14:14,15:15}]},{},[8])}("object"==typeof window&&window||"object"==typeof self&&self||this);

/*! pbjs -t static -o proto.js Transmission.proto */
var $Reader=protobuf.Reader,$Writer=protobuf.Writer,$util=protobuf.util;Spectrum=function(){function e(e){if(this.R=[],this.G=[],this.B=[],this.A=[],this.H=[],this.S=[],this.L=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.R=$util.emptyArray,e.prototype.G=$util.emptyArray,e.prototype.B=$util.emptyArray,e.prototype.A=$util.emptyArray,e.prototype.H=$util.emptyArray,e.prototype.S=$util.emptyArray,e.prototype.L=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.R&&e.R.length){t.uint32(10).fork();for(var r=0;r<e.R.length;++r)t.int32(e.R[r]);t.ldelim()}if(null!=e.G&&e.G.length){t.uint32(18).fork();for(var r=0;r<e.G.length;++r)t.int32(e.G[r]);t.ldelim()}if(null!=e.B&&e.B.length){t.uint32(26).fork();for(var r=0;r<e.B.length;++r)t.int32(e.B[r]);t.ldelim()}if(null!=e.A&&e.A.length){t.uint32(34).fork();for(var r=0;r<e.A.length;++r)t.int32(e.A[r]);t.ldelim()}if(null!=e.H&&e.H.length){t.uint32(42).fork();for(var r=0;r<e.H.length;++r)t.int32(e.H[r]);t.ldelim()}if(null!=e.S&&e.S.length){t.uint32(50).fork();for(var r=0;r<e.S.length;++r)t.int32(e.S[r]);t.ldelim()}if(null!=e.L&&e.L.length){t.uint32(58).fork();for(var r=0;r<e.L.length;++r)t.int32(e.L[r]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(t,r){t instanceof $Reader||(t=$Reader.create(t));for(var n=void 0===r?t.len:t.pos+r,i=new e;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:if(i.R&&i.R.length||(i.R=[]),2===(7&o))for(var a=t.uint32()+t.pos;t.pos<a;)i.R.push(t.int32());else i.R.push(t.int32());break;case 2:if(i.G&&i.G.length||(i.G=[]),2===(7&o))for(var a=t.uint32()+t.pos;t.pos<a;)i.G.push(t.int32());else i.G.push(t.int32());break;case 3:if(i.B&&i.B.length||(i.B=[]),2===(7&o))for(var a=t.uint32()+t.pos;t.pos<a;)i.B.push(t.int32());else i.B.push(t.int32());break;case 4:if(i.A&&i.A.length||(i.A=[]),2===(7&o))for(var a=t.uint32()+t.pos;t.pos<a;)i.A.push(t.int32());else i.A.push(t.int32());break;case 5:if(i.H&&i.H.length||(i.H=[]),2===(7&o))for(var a=t.uint32()+t.pos;t.pos<a;)i.H.push(t.int32());else i.H.push(t.int32());break;case 6:if(i.S&&i.S.length||(i.S=[]),2===(7&o))for(var a=t.uint32()+t.pos;t.pos<a;)i.S.push(t.int32());else i.S.push(t.int32());break;case 7:if(i.L&&i.L.length||(i.L=[]),2===(7&o))for(var a=t.uint32()+t.pos;t.pos<a;)i.L.push(t.int32());else i.L.push(t.int32());break;default:t.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof $Reader||(e=$Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.R&&e.hasOwnProperty("R")){if(!Array.isArray(e.R))return"R: array expected";for(var t=0;t<e.R.length;++t)if(!$util.isInteger(e.R[t]))return"R: integer[] expected"}if(null!=e.G&&e.hasOwnProperty("G")){if(!Array.isArray(e.G))return"G: array expected";for(var t=0;t<e.G.length;++t)if(!$util.isInteger(e.G[t]))return"G: integer[] expected"}if(null!=e.B&&e.hasOwnProperty("B")){if(!Array.isArray(e.B))return"B: array expected";for(var t=0;t<e.B.length;++t)if(!$util.isInteger(e.B[t]))return"B: integer[] expected"}if(null!=e.A&&e.hasOwnProperty("A")){if(!Array.isArray(e.A))return"A: array expected";for(var t=0;t<e.A.length;++t)if(!$util.isInteger(e.A[t]))return"A: integer[] expected"}if(null!=e.H&&e.hasOwnProperty("H")){if(!Array.isArray(e.H))return"H: array expected";for(var t=0;t<e.H.length;++t)if(!$util.isInteger(e.H[t]))return"H: integer[] expected"}if(null!=e.S&&e.hasOwnProperty("S")){if(!Array.isArray(e.S))return"S: array expected";for(var t=0;t<e.S.length;++t)if(!$util.isInteger(e.S[t]))return"S: integer[] expected"}if(null!=e.L&&e.hasOwnProperty("L")){if(!Array.isArray(e.L))return"L: array expected";for(var t=0;t<e.L.length;++t)if(!$util.isInteger(e.L[t]))return"L: integer[] expected"}return null},e.fromObject=function(t){if(t instanceof e)return t;var r=new e;if(t.R){if(!Array.isArray(t.R))throw TypeError(".Spectrum.R: array expected");r.R=[];for(var n=0;n<t.R.length;++n)r.R[n]=0|t.R[n]}if(t.G){if(!Array.isArray(t.G))throw TypeError(".Spectrum.G: array expected");r.G=[];for(var n=0;n<t.G.length;++n)r.G[n]=0|t.G[n]}if(t.B){if(!Array.isArray(t.B))throw TypeError(".Spectrum.B: array expected");r.B=[];for(var n=0;n<t.B.length;++n)r.B[n]=0|t.B[n]}if(t.A){if(!Array.isArray(t.A))throw TypeError(".Spectrum.A: array expected");r.A=[];for(var n=0;n<t.A.length;++n)r.A[n]=0|t.A[n]}if(t.H){if(!Array.isArray(t.H))throw TypeError(".Spectrum.H: array expected");r.H=[];for(var n=0;n<t.H.length;++n)r.H[n]=0|t.H[n]}if(t.S){if(!Array.isArray(t.S))throw TypeError(".Spectrum.S: array expected");r.S=[];for(var n=0;n<t.S.length;++n)r.S[n]=0|t.S[n]}if(t.L){if(!Array.isArray(t.L))throw TypeError(".Spectrum.L: array expected");r.L=[];for(var n=0;n<t.L.length;++n)r.L[n]=0|t.L[n]}return r},e.from=e.fromObject,e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.R=[],r.G=[],r.B=[],r.A=[],r.H=[],r.S=[],r.L=[]),e.R&&e.R.length){r.R=[];for(var n=0;n<e.R.length;++n)r.R[n]=e.R[n]}if(e.G&&e.G.length){r.G=[];for(var n=0;n<e.G.length;++n)r.G[n]=e.G[n]}if(e.B&&e.B.length){r.B=[];for(var n=0;n<e.B.length;++n)r.B[n]=e.B[n]}if(e.A&&e.A.length){r.A=[];for(var n=0;n<e.A.length;++n)r.A[n]=e.A[n]}if(e.H&&e.H.length){r.H=[];for(var n=0;n<e.H.length;++n)r.H[n]=e.H[n]}if(e.S&&e.S.length){r.S=[];for(var n=0;n<e.S.length;++n)r.S[n]=e.S[n]}if(e.L&&e.L.length){r.L=[];for(var n=0;n<e.L.length;++n)r.L[n]=e.L[n]}return r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,protobuf.util.toJSONOptions)},e}(),Transmission=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Timestamp=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.Name="",e.prototype.Entropy="",e.prototype.Spectrum=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.Timestamp&&e.hasOwnProperty("Timestamp")&&t.uint32(8).int64(e.Timestamp),null!=e.Name&&e.hasOwnProperty("Name")&&t.uint32(18).string(e.Name),null!=e.Entropy&&e.hasOwnProperty("Entropy")&&t.uint32(26).string(e.Entropy),null!=e.Spectrum&&e.hasOwnProperty("Spectrum")&&Spectrum.encode(e.Spectrum,t.uint32(34).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(t,r){t instanceof $Reader||(t=$Reader.create(t));for(var n=void 0===r?t.len:t.pos+r,i=new e;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:i.Timestamp=t.int64();break;case 2:i.Name=t.string();break;case 3:i.Entropy=t.string();break;case 4:i.Spectrum=Spectrum.decode(t,t.uint32());break;default:t.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof $Reader||(e=$Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.Timestamp&&e.hasOwnProperty("Timestamp")&&!($util.isInteger(e.Timestamp)||e.Timestamp&&$util.isInteger(e.Timestamp.low)&&$util.isInteger(e.Timestamp.high)))return"Timestamp: integer|Long expected";if(null!=e.Name&&e.hasOwnProperty("Name")&&!$util.isString(e.Name))return"Name: string expected";if(null!=e.Entropy&&e.hasOwnProperty("Entropy")&&!$util.isString(e.Entropy))return"Entropy: string expected";if(null!=e.Spectrum&&e.hasOwnProperty("Spectrum")){var t=Spectrum.verify(e.Spectrum);if(t)return"Spectrum."+t}return null},e.fromObject=function(t){if(t instanceof e)return t;var r=new e;if(null!=t.Timestamp&&($util.Long?(r.Timestamp=$util.Long.fromValue(t.Timestamp)).unsigned=!1:"string"==typeof t.Timestamp?r.Timestamp=parseInt(t.Timestamp,10):"number"==typeof t.Timestamp?r.Timestamp=t.Timestamp:"object"==typeof t.Timestamp&&(r.Timestamp=new $util.LongBits(t.Timestamp.low>>>0,t.Timestamp.high>>>0).toNumber())),null!=t.Name&&(r.Name=String(t.Name)),null!=t.Entropy&&(r.Entropy=String(t.Entropy)),null!=t.Spectrum){if("object"!=typeof t.Spectrum)throw TypeError(".Transmission.Spectrum: object expected");r.Spectrum=Spectrum.fromObject(t.Spectrum)}return r},e.from=e.fromObject,e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if($util.Long){var n=new $util.Long(0,0,!1);r.Timestamp=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.Timestamp=t.longs===String?"0":0;r.Name="",r.Entropy="",r.Spectrum=null}return null!=e.Timestamp&&e.hasOwnProperty("Timestamp")&&("number"==typeof e.Timestamp?r.Timestamp=t.longs===String?String(e.Timestamp):e.Timestamp:r.Timestamp=t.longs===String?$util.Long.prototype.toString.call(e.Timestamp):t.longs===Number?new $util.LongBits(e.Timestamp.low>>>0,e.Timestamp.high>>>0).toNumber():e.Timestamp),null!=e.Name&&e.hasOwnProperty("Name")&&(r.Name=e.Name),null!=e.Entropy&&e.hasOwnProperty("Entropy")&&(r.Entropy=e.Entropy),null!=e.Spectrum&&e.hasOwnProperty("Spectrum")&&(r.Spectrum=Spectrum.toObject(e.Spectrum,t)),r},e.prototype.toObject=function(e){return this.constructor.toObject(this,e)},e.prototype.toJSON=function(){return this.constructor.toObject(this,protobuf.util.toJSONOptions)},e}();

/*! ReconnectingWebSocket 1.0.1 | https://github.com/joewalnes/reconnecting-websocket | (c) Joe Walnes | MIT license */
(function(a,c){"function"===typeof define&&define.amd?define([],c):"undefined"!==typeof module&&module.exports?module.exports=c():a.ReconnectingWebSocket=c()})(this,function(){function a(c,q,h){function g(b,a){var d=document.createEvent("CustomEvent");d.initCustomEvent(b,!1,!1,a);return d}var n={debug:!1,automaticOpen:!0,reconnectInterval:1E3,maxReconnectInterval:3E4,reconnectDecay:1.5,timeoutInterval:2E3,maxReconnectAttempts:null,binaryType:"arraybuffer"};h||(h={});for(var l in n)this[l]="undefined"!==typeof h[l]?h[l]:n[l];this.url=c;this.reconnectAttempts=0;this.readyState=WebSocket.CONNECTING;this.protocol=null;var b=this,e,p=!1,m=!1,d=document.createElement("div");d.addEventListener("open",function(a){b.onopen(a)});d.addEventListener("close",function(a){b.onclose(a)});d.addEventListener("connecting",function(a){b.onconnecting(a)});d.addEventListener("message",function(a){b.onmessage(a)});d.addEventListener("error",function(a){b.onerror(a)});this.addEventListener=d.addEventListener.bind(d);this.removeEventListener=d.removeEventListener.bind(d);this.dispatchEvent=d.dispatchEvent.bind(d);this.open=function(k){e=new WebSocket(b.url,q||[]);e.binaryType=this.binaryType;if(k){if(this.maxReconnectAttempts&&this.reconnectAttempts>this.maxReconnectAttempts)return}else d.dispatchEvent(g("connecting")),this.reconnectAttempts=0;(b.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",b.url);var c=e,h=setTimeout(function(){(b.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",b.url);m=!0;c.close();m=!1},b.timeoutInterval);e.onopen=function(c){clearTimeout(h);(b.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","onopen",b.url);b.protocol=e.protocol;b.readyState=WebSocket.OPEN;b.reconnectAttempts=0;c=g("open");c.isReconnect=k;k=!1;d.dispatchEvent(c)};e.onclose=function(c){clearTimeout(f);e=null;if(p)b.readyState=WebSocket.CLOSED,d.dispatchEvent(g("close"));else{b.readyState=WebSocket.CONNECTING;f=g("connecting");f.code=c.code;f.reason=c.reason;f.wasClean=c.wasClean;d.dispatchEvent(f);k||m||((b.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","onclose",b.url),d.dispatchEvent(g("close")));var f=b.reconnectInterval*Math.pow(b.reconnectDecay,b.reconnectAttempts);setTimeout(function(){b.reconnectAttempts++;b.open(!0)},f>b.maxReconnectInterval?b.maxReconnectInterval:f)}};e.onmessage=function(c){(b.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",b.url,c.data);var e=g("message");e.data=c.data;d.dispatchEvent(e)};e.onerror=function(c){(b.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","onerror",b.url,c);d.dispatchEvent(g("error"))}};1==this.automaticOpen&&this.open(!1);this.send=function(c){if(e)return(b.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","send",b.url,c),e.send(c);throw"INVALID_STATE_ERR : Pausing to reconnect websocket";};this.close=function(b,a){"undefined"==typeof b&&(b=1E3);p=!0;e&&e.close(b,a)};this.refresh=function(){e&&e.close()}}if("WebSocket"in window)return a.prototype.onopen=function(a){},a.prototype.onclose=function(a){},a.prototype.onconnecting=function(a){},a.prototype.onmessage=function(a){},a.prototype.onerror=function(a){},a.debugAll=!1,a.CONNECTING=WebSocket.CONNECTING,a.OPEN=WebSocket.OPEN,a.CLOSING=WebSocket.CLOSING,a.CLOSED=WebSocket.CLOSED,a});

/*! SweetAlert | 2014-2015 (c) - Tristan Edwards | github.com/t4t5/sweetalert | MIT license */
!function(e,t,n){"use strict";!function o(e,t,n){function a(s,l){if(!t[s]){if(!e[s]){var i="function"==typeof require&&require;if(!l&&i)return i(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=t[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return a(n?n:t)},c,c.exports,o,e,t,n)}return t[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(o){var a,r,s,l,i=function(e){return e&&e.__esModule?e:{"default":e}},u=o("./modules/handle-dom"),c=o("./modules/utils"),d=o("./modules/handle-swal-dom"),f=o("./modules/handle-click"),p=o("./modules/handle-key"),m=i(p),v=o("./modules/default-params"),y=i(v),h=o("./modules/set-params"),g=i(h);s=l=function(){function o(e){var t=s;return t[e]===n?y["default"][e]:t[e]}var s=arguments[0];if(u.addClass(t.body,"stop-scrolling"),d.resetInput(),s===n)return c.logStr("SweetAlert expects at least 1 attribute!"),!1;var i=c.extend({},y["default"]);switch(typeof s){case"string":i.title=s,i.text=arguments[1]||"",i.type=arguments[2]||"";break;case"object":if(s.title===n)return c.logStr('Missing "title" argument!'),!1;i.title=s.title;for(var p in y["default"])i[p]=o(p);i.confirmButtonText=i.showCancelButton?"Confirm":y["default"].confirmButtonText,i.confirmButtonText=o("confirmButtonText"),i.doneFunction=arguments[1]||null;break;default:return c.logStr('Unexpected type of argument! Expected "string" or "object", got '+typeof s),!1}g["default"](i),d.fixVerticalPosition(),d.openModal(arguments[1]);for(var v=d.getModal(),h=v.querySelectorAll("button"),b=["onclick","onmouseover","onmouseout","onmousedown","onmouseup","onfocus"],w=function(e){return f.handleButton(e,i,v)},C=0;C<h.length;C++)for(var S=0;S<b.length;S++){var x=b[S];h[C][x]=w}d.getOverlay().onclick=w,a=e.onkeydown;var k=function(e){return m["default"](e,i,v)};e.onkeydown=k,e.onfocus=function(){setTimeout(function(){r!==n&&(r.focus(),r=n)},0)},l.enableButtons()},s.setDefaults=l.setDefaults=function(e){if(!e)throw new Error("userParams is required");if("object"!=typeof e)throw new Error("userParams has to be a object");c.extend(y["default"],e)},s.close=l.close=function(){var o=d.getModal();u.fadeOut(d.getOverlay(),5),u.fadeOut(o,5),u.removeClass(o,"showSweetAlert"),u.addClass(o,"hideSweetAlert"),u.removeClass(o,"visible");var s=o.querySelector(".sa-icon.sa-success");u.removeClass(s,"animate"),u.removeClass(s.querySelector(".sa-tip"),"animateSuccessTip"),u.removeClass(s.querySelector(".sa-long"),"animateSuccessLong");var l=o.querySelector(".sa-icon.sa-error");u.removeClass(l,"animateErrorIcon"),u.removeClass(l.querySelector(".sa-x-mark"),"animateXMark");var i=o.querySelector(".sa-icon.sa-warning");return u.removeClass(i,"pulseWarning"),u.removeClass(i.querySelector(".sa-body"),"pulseWarningIns"),u.removeClass(i.querySelector(".sa-dot"),"pulseWarningIns"),setTimeout(function(){var e=o.getAttribute("data-custom-class");u.removeClass(o,e)},300),u.removeClass(t.body,"stop-scrolling"),e.onkeydown=a,e.previousActiveElement&&e.previousActiveElement.focus(),r=n,clearTimeout(o.timeout),!0},s.showInputError=l.showInputError=function(e){var t=d.getModal(),n=t.querySelector(".sa-input-error");u.addClass(n,"show");var o=t.querySelector(".sa-error-container");u.addClass(o,"show"),o.querySelector("p").innerHTML=e,setTimeout(function(){s.enableButtons()},1),t.querySelector("input").focus()},s.resetInputError=l.resetInputError=function(e){if(e&&13===e.keyCode)return!1;var t=d.getModal(),n=t.querySelector(".sa-input-error");u.removeClass(n,"show");var o=t.querySelector(".sa-error-container");u.removeClass(o,"show")},s.disableButtons=l.disableButtons=function(){var e=d.getModal(),t=e.querySelector("button.confirm"),n=e.querySelector("button.cancel");t.disabled=!0,n.disabled=!0},s.enableButtons=l.enableButtons=function(){var e=d.getModal(),t=e.querySelector("button.confirm"),n=e.querySelector("button.cancel");t.disabled=!1,n.disabled=!1},"undefined"!=typeof e?e.sweetAlert=e.swal=s:c.logStr("SweetAlert is a frontend module!")},{"./modules/default-params":2,"./modules/handle-click":3,"./modules/handle-dom":4,"./modules/handle-key":5,"./modules/handle-swal-dom":6,"./modules/set-params":8,"./modules/utils":9}],2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o={title:"",text:"",type:null,allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!1,closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",confirmButtonColor:"#8CD4F5",cancelButtonText:"Cancel",imageUrl:null,imageSize:null,timer:null,customClass:"",html:!1,animation:!0,allowEscapeKey:!0,inputType:"text",inputPlaceholder:"",inputValue:"",showLoaderOnConfirm:!1};n["default"]=o,t.exports=n["default"]},{}],3:[function(t,n,o){Object.defineProperty(o,"__esModule",{value:!0});var a=t("./utils"),r=(t("./handle-swal-dom"),t("./handle-dom")),s=function(t,n,o){function s(e){m&&n.confirmButtonColor&&(p.style.backgroundColor=e)}var u,c,d,f=t||e.event,p=f.target||f.srcElement,m=-1!==p.className.indexOf("confirm"),v=-1!==p.className.indexOf("sweet-overlay"),y=r.hasClass(o,"visible"),h=n.doneFunction&&"true"===o.getAttribute("data-has-done-function");switch(m&&n.confirmButtonColor&&(u=n.confirmButtonColor,c=a.colorLuminance(u,-.04),d=a.colorLuminance(u,-.14)),f.type){case"mouseover":s(c);break;case"mouseout":s(u);break;case"mousedown":s(d);break;case"mouseup":s(c);break;case"focus":var g=o.querySelector("button.confirm"),b=o.querySelector("button.cancel");m?b.style.boxShadow="none":g.style.boxShadow="none";break;case"click":var w=o===p,C=r.isDescendant(o,p);if(!w&&!C&&y&&!n.allowOutsideClick)break;m&&h&&y?l(o,n):h&&y||v?i(o,n):r.isDescendant(o,p)&&"BUTTON"===p.tagName&&sweetAlert.close()}},l=function(e,t){var n=!0;r.hasClass(e,"show-input")&&(n=e.querySelector("input").value,n||(n="")),t.doneFunction(n),t.closeOnConfirm&&sweetAlert.close(),t.showLoaderOnConfirm&&sweetAlert.disableButtons()},i=function(e,t){var n=String(t.doneFunction).replace(/\s/g,""),o="function("===n.substring(0,9)&&")"!==n.substring(9,10);o&&t.doneFunction(!1),t.closeOnCancel&&sweetAlert.close()};o["default"]={handleButton:s,handleConfirm:l,handleCancel:i},n.exports=o["default"]},{"./handle-dom":4,"./handle-swal-dom":6,"./utils":9}],4:[function(n,o,a){Object.defineProperty(a,"__esModule",{value:!0});var r=function(e,t){return new RegExp(" "+t+" ").test(" "+e.className+" ")},s=function(e,t){r(e,t)||(e.className+=" "+t)},l=function(e,t){var n=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(r(e,t)){for(;n.indexOf(" "+t+" ")>=0;)n=n.replace(" "+t+" "," ");e.className=n.replace(/^\s+|\s+$/g,"")}},i=function(e){var n=t.createElement("div");return n.appendChild(t.createTextNode(e)),n.innerHTML},u=function(e){e.style.opacity="",e.style.display="block"},c=function(e){if(e&&!e.length)return u(e);for(var t=0;t<e.length;++t)u(e[t])},d=function(e){e.style.opacity="",e.style.display="none"},f=function(e){if(e&&!e.length)return d(e);for(var t=0;t<e.length;++t)d(e[t])},p=function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1},m=function(e){e.style.left="-9999px",e.style.display="block";var t,n=e.clientHeight;return t="undefined"!=typeof getComputedStyle?parseInt(getComputedStyle(e).getPropertyValue("padding-top"),10):parseInt(e.currentStyle.padding),e.style.left="",e.style.display="none","-"+parseInt((n+t)/2)+"px"},v=function(e,t){if(+e.style.opacity<1){t=t||16,e.style.opacity=0,e.style.display="block";var n=+new Date,o=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){e.style.opacity=+e.style.opacity+(new Date-n)/100,n=+new Date,+e.style.opacity<1&&setTimeout(o,t)});o()}e.style.display="block"},y=function(e,t){t=t||16,e.style.opacity=1;var n=+new Date,o=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){e.style.opacity=+e.style.opacity-(new Date-n)/100,n=+new Date,+e.style.opacity>0?setTimeout(o,t):e.style.display="none"});o()},h=function(n){if("function"==typeof MouseEvent){var o=new MouseEvent("click",{view:e,bubbles:!1,cancelable:!0});n.dispatchEvent(o)}else if(t.createEvent){var a=t.createEvent("MouseEvents");a.initEvent("click",!1,!1),n.dispatchEvent(a)}else t.createEventObject?n.fireEvent("onclick"):"function"==typeof n.onclick&&n.onclick()},g=function(t){"function"==typeof t.stopPropagation?(t.stopPropagation(),t.preventDefault()):e.event&&e.event.hasOwnProperty("cancelBubble")&&(e.event.cancelBubble=!0)};a.hasClass=r,a.addClass=s,a.removeClass=l,a.escapeHtml=i,a._show=u,a.show=c,a._hide=d,a.hide=f,a.isDescendant=p,a.getTopMargin=m,a.fadeIn=v,a.fadeOut=y,a.fireClick=h,a.stopEventPropagation=g},{}],5:[function(t,o,a){Object.defineProperty(a,"__esModule",{value:!0});var r=t("./handle-dom"),s=t("./handle-swal-dom"),l=function(t,o,a){var l=t||e.event,i=l.keyCode||l.which,u=a.querySelector("button.confirm"),c=a.querySelector("button.cancel"),d=a.querySelectorAll("button[tabindex]");if(-1!==[9,13,32,27].indexOf(i)){for(var f=l.target||l.srcElement,p=-1,m=0;m<d.length;m++)if(f===d[m]){p=m;break}9===i?(f=-1===p?u:p===d.length-1?d[0]:d[p+1],r.stopEventPropagation(l),f.focus(),o.confirmButtonColor&&s.setFocusStyle(f,o.confirmButtonColor)):13===i?("INPUT"===f.tagName&&(f=u,u.focus()),f=-1===p?u:n):27===i&&o.allowEscapeKey===!0?(f=c,r.fireClick(f,l)):f=n}};a["default"]=l,o.exports=a["default"]},{"./handle-dom":4,"./handle-swal-dom":6}],6:[function(n,o,a){var r=function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(a,"__esModule",{value:!0});var s=n("./utils"),l=n("./handle-dom"),i=n("./default-params"),u=r(i),c=n("./injected-html"),d=r(c),f=".sweet-alert",p=".sweet-overlay",m=function(){var e=t.createElement("div");for(e.innerHTML=d["default"];e.firstChild;)t.body.appendChild(e.firstChild)},v=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=t.querySelector(f);return e||(m(),e=v()),e}),y=function(){var e=v();return e?e.querySelector("input"):void 0},h=function(){return t.querySelector(p)},g=function(e,t){var n=s.hexToRgb(t);e.style.boxShadow="0 0 2px rgba("+n+", 0.8), inset 0 0 0 1px rgba(0, 0, 0, 0.05)"},b=function(n){var o=v();l.fadeIn(h(),10),l.show(o),l.addClass(o,"showSweetAlert"),l.removeClass(o,"hideSweetAlert"),e.previousActiveElement=t.activeElement;var a=o.querySelector("button.confirm");a.focus(),setTimeout(function(){l.addClass(o,"visible")},500);var r=o.getAttribute("data-timer");if("null"!==r&&""!==r){var s=n;o.timeout=setTimeout(function(){var e=(s||null)&&"true"===o.getAttribute("data-has-done-function");e?s(null):sweetAlert.close()},r)}},w=function(){var e=v(),t=y();l.removeClass(e,"show-input"),t.value=u["default"].inputValue,t.setAttribute("type",u["default"].inputType),t.setAttribute("placeholder",u["default"].inputPlaceholder),C()},C=function(e){if(e&&13===e.keyCode)return!1;var t=v(),n=t.querySelector(".sa-input-error");l.removeClass(n,"show");var o=t.querySelector(".sa-error-container");l.removeClass(o,"show")},S=function(){var e=v();e.style.marginTop=l.getTopMargin(v())};a.sweetAlertInitialize=m,a.getModal=v,a.getOverlay=h,a.getInput=y,a.setFocusStyle=g,a.openModal=b,a.resetInput=w,a.resetInputError=C,a.fixVerticalPosition=S},{"./default-params":2,"./handle-dom":4,"./injected-html":7,"./utils":9}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o='<div class="sweet-overlay" tabIndex="-1"></div><div class="sweet-alert"><div class="sa-icon sa-error">\n      <span class="sa-x-mark">\n        <span class="sa-line sa-left"></span>\n        <span class="sa-line sa-right"></span>\n      </span>\n    </div><div class="sa-icon sa-warning">\n      <span class="sa-body"></span>\n      <span class="sa-dot"></span>\n    </div><div class="sa-icon sa-info"></div><div class="sa-icon sa-success">\n      <span class="sa-line sa-tip"></span>\n      <span class="sa-line sa-long"></span>\n\n      <div class="sa-placeholder"></div>\n      <div class="sa-fix"></div>\n    </div><div class="sa-icon sa-custom"></div><h2>Title</h2>\n    <p>Text</p>\n    <fieldset>\n      <input type="text" tabIndex="3" />\n      <div class="sa-input-error"></div>\n    </fieldset><div class="sa-error-container">\n      <div class="icon">!</div>\n      <p>Not valid!</p>\n    </div><div class="sa-button-container">\n      <button class="cancel" tabIndex="2">Cancel</button>\n      <div class="sa-confirm-button-container">\n        <button class="confirm" tabIndex="1">OK</button><div class="la-ball-fall">\n          <div></div>\n          <div></div>\n          <div></div>\n        </div>\n      </div>\n    </div></div>';n["default"]=o,t.exports=n["default"]},{}],8:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var a=e("./utils"),r=e("./handle-swal-dom"),s=e("./handle-dom"),l=["error","warning","info","success","input","prompt"],i=function(e){var t=r.getModal(),o=t.querySelector("h2"),i=t.querySelector("p"),u=t.querySelector("button.cancel"),c=t.querySelector("button.confirm");if(o.innerHTML=e.html?e.title:s.escapeHtml(e.title).split("\n").join("<br>"),i.innerHTML=e.html?e.text:s.escapeHtml(e.text||"").split("\n").join("<br>"),e.text&&s.show(i),e.customClass)s.addClass(t,e.customClass),t.setAttribute("data-custom-class",e.customClass);else{var d=t.getAttribute("data-custom-class");s.removeClass(t,d),t.setAttribute("data-custom-class","")}if(s.hide(t.querySelectorAll(".sa-icon")),e.type&&!a.isIE8()){var f=function(){for(var o=!1,a=0;a<l.length;a++)if(e.type===l[a]){o=!0;break}if(!o)return logStr("Unknown alert type: "+e.type),{v:!1};var i=["success","error","warning","info"],u=n;-1!==i.indexOf(e.type)&&(u=t.querySelector(".sa-icon.sa-"+e.type),s.show(u));var c=r.getInput();switch(e.type){case"success":s.addClass(u,"animate"),s.addClass(u.querySelector(".sa-tip"),"animateSuccessTip"),s.addClass(u.querySelector(".sa-long"),"animateSuccessLong");break;case"error":s.addClass(u,"animateErrorIcon"),s.addClass(u.querySelector(".sa-x-mark"),"animateXMark");break;case"warning":s.addClass(u,"pulseWarning"),s.addClass(u.querySelector(".sa-body"),"pulseWarningIns"),s.addClass(u.querySelector(".sa-dot"),"pulseWarningIns");break;case"input":case"prompt":c.setAttribute("type",e.inputType),c.value=e.inputValue,c.setAttribute("placeholder",e.inputPlaceholder),s.addClass(t,"show-input"),setTimeout(function(){c.focus(),c.addEventListener("keyup",swal.resetInputError)},400)}}();if("object"==typeof f)return f.v}if(e.imageUrl){var p=t.querySelector(".sa-icon.sa-custom");p.style.backgroundImage="url("+e.imageUrl+")",s.show(p);var m=80,v=80;if(e.imageSize){var y=e.imageSize.toString().split("x"),h=y[0],g=y[1];h&&g?(m=h,v=g):logStr("Parameter imageSize expects value with format WIDTHxHEIGHT, got "+e.imageSize)}}t.setAttribute("data-has-cancel-button",e.showCancelButton),e.showCancelButton?u.style.display="inline-block":s.hide(u),t.setAttribute("data-has-confirm-button",e.showConfirmButton),e.showConfirmButton?c.style.display="inline-block":s.hide(c),e.cancelButtonText&&(u.innerHTML=s.escapeHtml(e.cancelButtonText)),e.confirmButtonText&&(c.innerHTML=s.escapeHtml(e.confirmButtonText)),e.confirmButtonColor&&(c.style.backgroundColor=e.confirmButtonColor,c.style.borderLeftColor=e.confirmLoadingButtonColor,c.style.borderRightColor=e.confirmLoadingButtonColor,r.setFocusStyle(c,e.confirmButtonColor)),t.setAttribute("data-allow-outside-click",e.allowOutsideClick);var b=e.doneFunction?!0:!1;t.setAttribute("data-has-done-function",b),e.animation?"string"==typeof e.animation?t.setAttribute("data-animation",e.animation):t.setAttribute("data-animation","pop"):t.setAttribute("data-animation","none"),t.setAttribute("data-timer",e.timer)};o["default"]=i,t.exports=o["default"]},{"./handle-dom":4,"./handle-swal-dom":6,"./utils":9}],9:[function(t,n,o){Object.defineProperty(o,"__esModule",{value:!0});var a=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},r=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?parseInt(t[1],16)+", "+parseInt(t[2],16)+", "+parseInt(t[3],16):null},s=function(){return e.attachEvent&&!e.addEventListener},l=function(t){e.console&&e.console.log("SweetAlert: "+t)},i=function(e,t){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var n,o,a="#";for(o=0;3>o;o++)n=parseInt(e.substr(2*o,2),16),n=Math.round(Math.min(Math.max(0,n+n*t),255)).toString(16),a+=("00"+n).substr(n.length);return a};o.extend=a,o.hexToRgb=r,o.isIE8=s,o.logStr=l,o.colorLuminance=i},{}]},{},[1]),"function"==typeof define&&define.amd?define(function(){return sweetAlert}):"undefined"!=typeof module&&module.exports&&(module.exports=sweetAlert)}(window,document);

/*! https://developer.mozilla.org/en/docs/Web/API/WindowBase64/Base64_encoding_and_decoding */
function b64Enc(str) {
	return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (match, p1) => {
		return String.fromCharCode("0x" + p1);
	}));
}
function b64Dec(str) {
	return decodeURIComponent(atob(str).split("").map((c) => {
		return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
	}).join(""));
}

function tryB64Dec(str) {
	try { return b64Dec(str); } catch(e) { return str; }
}

function ticksToDate(ticks) {
	return new Date(ticks / 10000 - 62135596800000);
}

var WIDTH = 256;
var HEIGHT = 32;
var HALFHEIGHT = HEIGHT / 2;

var WHITE = "#fff";
var RED = "#ff7f7f";
var GREEN = "#7fff7f";
var BLUE = "#7f7fff";

function DrawSpectrum(canvas, msg) {
	function amax(array) {
		return Math.max.apply(null, array);
	}

	function drawDown(ctx, arr, color) {
		ctx.fillStyle = color;
		var maxv = amax(arr);
		for(var i = 0; i < arr.length; i++) {
			ctx.fillRect(i, HALFHEIGHT, 1, HALFHEIGHT * arr[i] / maxv);
		}
	}

	function drawUp(ctx, arr, color) {
		ctx.fillStyle = color;
		var maxv = amax(arr);
		for(var i = 0; i < arr.length; i++) {
			var height = HALFHEIGHT * arr[i] / maxv;
			ctx.fillRect(i, HALFHEIGHT - height, 1, height);
		}
	}

	var ctx = canvas.getContext("2d");
	ctx.clearRect(0, 0, WIDTH, HEIGHT);

	ctx.globalAlpha = 0.4;
	drawUp(ctx, msg.R, RED);
	drawUp(ctx, msg.G, GREEN);
	drawUp(ctx, msg.B, BLUE);

	ctx.globalAlpha = 0.2;
	drawDown(ctx, msg.H, WHITE);
	drawDown(ctx, msg.S, WHITE);
	drawDown(ctx, msg.L, WHITE);
}

var MAXSIZE = 65536;
var MAXNAMELENGTH = 340;

var SUCCESS = "rgba(127,0,127,0.5)";
var ERROR = "rgba(0,127,127,0.5)";
var OPEN = "rgba(127,127,0,0.5)";

var MAX_MSG_COUNT = 30;

var KEY_LENGTH = 44;

function showMessage($container, time, name, key, spectrum, error) {
	var $msgs = $container.find(".msg");
	var $msg = ($msgs.length > MAX_MSG_COUNT ? $msgs.last().remove() : $('<div class="msg"><div class="msg-text"/><div class="msg-error"/><canvas class="spectrum" width="' + WIDTH + '" height="' + HEIGHT + '"></canvas><div class="msg-key"/></div>'));
	var $canvas = $msg.find("canvas").data("name", name).data("key", key);
	var $error = $msg.find(".msg-error");
	var $key = $msg.find(".msg-key");
	if(!spectrum) { $canvas.hide(); } else { DrawSpectrum($canvas.show()[0], spectrum); }
	if(!error) { $error.hide(); } else { $error.text(error).show(); }
	if(!key) { $key.hide(); } else { $key.text(key).show(); }
	$msg.find(".msg-text").text(time + " " + tryB64Dec(name));
	$container.prepend($msg);
}

(() => {
	function find(name, key) {
		var xhr = new XMLHttpRequest();
		xhr.responseType = "arraybuffer";
		xhr.timeout = 3000;

		swal({ title: "Searching...", confirmButtonText: "Cancel", closeOnConfirm: false }, () => { xhr.abort(); });

		xhr.onreadystatechange = (event) => {
			if(xhr.readyState === XMLHttpRequest.DONE) {
				if(event.target.status === 200) {
					try {
						var msg = Transmission.decode(new Uint8Array(xhr.response));
						var time = new Date(ticksToDate(msg.Timestamp)).toLocaleTimeString();
						swal({ title: b64Dec(msg.Name), text: time + "\r\n\r\n" + tryB64Dec(msg.Entropy), type: "success" });
					} catch (e) {
						console.log(e);
					}
				} else {
					var error = window.TextDecoder && new TextDecoder("utf-8").decode(new Uint8Array(xhr.response)) || "Internal Stargåte Error";
					swal({ type: "error", title: "Cancelled", text: error, timer: 2000 });
				}
			}
		};

		xhr.open("GET", "/find/");
		xhr.setRequestHeader("X-SG1-Name", name);
		try{ xhr.setRequestHeader("X-SG1-Key", key); } catch(e) {}
		xhr.send();
	}

	$(document).on("click", ".spectrum", function() {
		var name = $(this).data("name");
		var key = $(this).data("key");
		if(!!key)
			find(name, key);
		else {
			swal({title: "Enter the key", type: "input", showCancelButton: true, closeOnConfirm: false, inputPlaceholder: "SG1 key"}, function(inputValue) {
				if(inputValue === false) return false;
				if(inputValue.length !== KEY_LENGTH) { swal.showInputError("Invalid SG1 key"); return false; }
				find(name, inputValue);
			});
		}
	});
})();

(() => {
	var stargate = $("#stargate")[0];

	var $status = $("#status");
	var $horizon = $("#EventHorizon");

	function ChangeEventHorizonState(state, msg) {
		if(msg)
			$status.text(msg);
		if(state)
			$horizon.attr("fill", state);
		else
			$horizon.removeAttr("fill");
	}

	if(typeof(window.FileReader) == "undefined") {
		ChangeEventHorizonState(ERROR, "Update Your Dial Device");
	}

	stargate.ondragover = () => { ChangeEventHorizonState(OPEN); return false; };
	stargate.ondragleave = () => { ChangeEventHorizonState(); return false; };

	stargate.ondrop = (event) => {
		event.preventDefault();
		$status.text("Outgoing...");

		var files = event.dataTransfer.files;
		if(files.length !== 1) {
			ChangeEventHorizonState(ERROR, "Invalid Substance");
			return false;
		}

		var file = files[0];

		var b64name = b64Enc(file.name);
		if(b64name > MAXNAMELENGTH) {
			var tooLongError = "Name Too Long";
			showMessage($(".right-container"), new Date().toLocaleTimeString(), b64name, null, null, tooLongError);
			ChangeEventHorizonState(ERROR, tooLongError);
			return false;
		}

		if(file.size > MAXSIZE) {
			var tooLargeError = "Substance Too Large";
			showMessage($(".right-container"), new Date().toLocaleTimeString(), b64name, null, null, tooLargeError);
			ChangeEventHorizonState(ERROR, tooLargeError);
			return false;
		}

		var xhr = new XMLHttpRequest();
		xhr.responseType = "arraybuffer";
		xhr.timeout = 5000;

		xhr.onreadystatechange = (event) => {
			if(xhr.readyState === XMLHttpRequest.DONE) {
				if(event.target.status === 200) {
					ChangeEventHorizonState(SUCCESS, "Substance Passed");
					try {
						var spectrum = Spectrum.decode(new Uint8Array(xhr.response));
						showMessage($(".right-container"), new Date().toLocaleTimeString(), b64name, xhr.getResponseHeader("X-SG1-Key"), spectrum);
					} catch (e) {
						console.log(e);
					}
				} else {
					var error = window.TextDecoder && new TextDecoder("utf-8").decode(new Uint8Array(xhr.response));
					showMessage($(".right-container"), new Date().toLocaleTimeString(), b64name, null, null, error);
					ChangeEventHorizonState(ERROR, error || "Internal Stargåte Error");
				}
			}
		};

		var entropy = new Uint8Array(16);
		window.crypto.getRandomValues(entropy);

		xhr.open('PUT', '/send/');
		xhr.setRequestHeader("X-SG1-Name", b64name);
		xhr.setRequestHeader("X-SG1-Entropy", btoa(String.fromCharCode.apply(null, entropy))); // Some secret entropy
		xhr.send(file);

		return true;
	};
})();

(() => {
	var socket = new ReconnectingWebSocket("ws://" + location.host.split(":")[0] + ":5001/");

	socket.binaryType = "arraybuffer";
	socket.timeoutInterval = 5000;
	socket.reconnectInterval = 3000;

	socket.onopen = () => { console.log("ws open"); };
	socket.onclose = () => { console.log("ws close"); };
	socket.onerror = (error) => { console.log("ws error: " + error.message); };
	socket.onmessage = (event) => {
		if(event && event.data) {
			if(event.data.length === 2 && event.data[0] === 'h' && event.data[1] === 'i')
				console.log("ws connected");
			else {
				try {
					var msg = Transmission.decode(new Uint8Array(event.data));
					var time = new Date(ticksToDate(msg.Timestamp)).toLocaleTimeString();
					showMessage($(".left-container"), time, msg.Name, null, msg.Spectrum);
				} catch (e) {
					console.log(e);
				}
			}
		}
	};

	$(window).on("beforeunload", () => { socket.close(); });
})();
